"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[705],{1385:function(e,t,E){var o=this&&this.__awaiter||function(e,t,E,o){return new(E||(E=Promise))(function(n,l){function r(e){try{i(o.next(e))}catch(e){l(e)}}function a(e){try{i(o.throw(e))}catch(e){l(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof E?t:new E(function(e){e(t)})).then(r,a)}i((o=o.apply(e,t||[])).next())})},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.initChannelMessagingFunctions=void 0;let l=E(6883),r=E(229),a=E(8079),i=n(E(9949)),s=n(E(54)),d=E(4066),_=E(3861),m=E(7728),u=E(8015),S=E(2276),g=E(7923),T=E(2922),M=E(624),y="IMMEDIATELY_REMOVE_POINTER_LOCK",I="LAST_NAV_TREE_REFRESH_TIME";t.initChannelMessagingFunctions=()=>{var e;(0,u.resetIntermediateClassesForSliderInstantUpdate)();let t=M.defaultUIUpdateRunner;String.prototype.hashCode=function(){var e,t=0;if(0===this.length)return t;for(e=0;e<this.length;e++)t=(t<<5)-t+this.charCodeAt(e)|0;return t};let E=!1,n=()=>{try{return{get passive(){return!1}}}catch(e){return!1}},c=(e=window.MutationObserver||window.WebKitMutationObserver,function(t,E){var o;let n=t.filter(e=>e&&1===e.nodeType);return 0===n.length?M.defaultUIUpdateRunner:(e?(o=new e(E),n.forEach(e=>{o.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0})})):window.addEventListener&&n.forEach(e=>{e.addEventListener("DOMNodeInserted",E,!1),e.addEventListener("DOMNodeRemoved",E,!1)}),e=>{o&&o.disconnect(),e(),o&&n.forEach(e=>{o.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0})})})}),L=e=>{let t=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY),E=S.TempoElement.fromKey(t),o=(0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE),n=null,i=e.target;for(;i&&!n;)n=o[(0,l.getElementKeyFromNode)(i)||""],i=i.parentElement;if(!n)return m.SELECT_OR_HOVER_STORYBOARD;let s=e=>{var t,n,l,r;if(E.isEmpty())throw Error("No selected element when isNavNodeMatch called");if(!e||!e.tempoElement.codebaseId.startsWith("tempo-")||e.tempoElement.codebaseId===a.SKIP_ROOT_CODEBASE_ID)return!1;if(E.isEqual(e.tempoElement)||e.tempoElement.isParentOf(E))return!0;let i=e.parent;for(;i&&!i.tempoElement.codebaseId.startsWith("tempo-");)i=i.parent;if(null==(t=null==i?void 0:i.tempoElement)?void 0:t.isEqual(E))return!0;let s=o[E.getKey()];return!!(s&&(null==(r=null==(l=null==(n=e.parent)?void 0:n.children)?void 0:l.includes)?void 0:r.call(l,s)))},d=null,_=n;for(;_;){if(E.isEmpty()||E.isStoryboard())_.tempoElement.codebaseId&&_.tempoElement.codebaseId.startsWith("tempo-")&&(d=_);else if(s(_)){d=_;break}_=_.parent}return d||null},O=(e,t,E,o)=>{let n,a=K(e,t,E),i=(0,g.getEditingInfo)();if(e.altKey||a&&!i||(0,r.getMemoryStorageItem)("mouseDragContext"))return;let s=(0,r.getMemoryStorageItem)(r.HOVERED_ELEMENT_KEY),_=(0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE)||{};e.metaKey||e.ctrlKey||o?(n=_[(0,l.getElementKeyFromNode)(e.target)])||e.target.parentNode!==document.body||(n=m.SELECT_OR_HOVER_STORYBOARD):n=L(e);let u=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY),T=S.TempoElement.fromKey(u);if(e.shiftKey&&n&&u&&("string"!=typeof n||T.isStoryboard()||(n=null),"string"==typeof n||(null==n?void 0:n.tempoElement.isSiblingOf(T))||(n=null)),!n){null!==s&&((0,r.setMemoryStorageItem)(r.HOVERED_ELEMENT_KEY,null),t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.HOVERED_ELEMENT_KEY,elementKey:null}),(0,d.updateOutlines)(t,E));return}if("string"==typeof n){if(n===m.SELECT_OR_HOVER_STORYBOARD){let e=S.TempoElement.forStoryboard(E).getKey();s!==e&&((0,r.setMemoryStorageItem)(r.HOVERED_ELEMENT_KEY,e),t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.HOVERED_ELEMENT_KEY,elementKey:e}),(0,d.updateOutlines)(t,E))}return}let M=n.tempoElement.getKey();s!==M&&(t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.HOVERED_ELEMENT_KEY,elementKey:M}),(0,r.setMemoryStorageItem)(r.HOVERED_ELEMENT_KEY,M),(0,d.updateOutlines)(t,E))},p=(e,t)=>{(0,r.getMemoryStorageItem)(r.HOVERED_ELEMENT_KEY)&&(e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.HOVERED_ELEMENT_KEY,elementKey:null}),(0,r.setMemoryStorageItem)(r.HOVERED_ELEMENT_KEY,null),(0,d.updateOutlines)(e,t))},N=(e,t,E)=>o(void 0,void 0,void 0,function*(){var o;K(e,t,E);let n=(0,r.getMemoryStorageItem)("mouseDragContext");!e.buttons&&n&&((0,r.setMemoryStorageItem)("mouseDragContext",null),(null==n?void 0:n.dragging)&&t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.DRAG_CANCEL_EVENT,event:{}}),n=null);let a={pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY};if((0,r.setMemoryStorageItem)("mousePos",a),t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.MOUSE_MOVE_EVENT,event:a}),n&&!n.dragging){let E=(0,r.getMemoryStorageItem)("zoomPerc")||1;if(Math.abs(n.pageX-e.pageX)+Math.abs(n.pageY-e.pageY)>=20/E&&(n.parentSelectedElementKey&&((0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE)||{})[n.parentSelectedElementKey]&&(t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:n.parentSelectedElementKey,outerHTML:null==(o=(0,l.getNodeForElementKey)(n.parentSelectedElementKey))?void 0:o.outerHTML}),(0,r.setMemoryStorageItem)(r.SELECTED_ELEMENT_KEY,n.parentSelectedElementKey)),!(0,r.getMemoryStorageItem)("aiContext"))){(0,r.setMemoryStorageItem)("mouseDragContext",Object.assign(Object.assign({},n),{dragging:!0}));let e=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY),E=(0,l.getNodeForElementKey)(e);t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.DRAG_START_EVENT,event:n,outerHTML:null==E?void 0:E.outerHTML});let o=(0,i.default)("body").get(0);(0,r.setMemoryStorageItem)(y,!0),yield null==o?void 0:o.requestPointerLock()}}(0,r.getMemoryStorageItem)("mouseDragContext")&&(0,d.updateOutlines)(t,E)}),D=e=>{let t;if(!e)return null;if(!(null==e?void 0:e.isComponent)){let t=(0,l.getNodeForElementKey)(e.tempoElement.getKey());return null==t?void 0:t.parentElement}return(((0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_LOOKUP_LIST)||{})[e.tempoElement.getKey()]||[]).forEach(e=>{t||(t=(0,l.getNodeForElementKey)(e))}),null==t?void 0:t.parentElement},v=(e,t,E)=>{let o,n;if(1!==e.which||(0,l.hasClass)(e.target,l.EDIT_TEXT_BUTTON)||K(e,t,E))return;let a=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY),i=S.TempoElement.fromKey(a),s=A(e,t,E),m=!i.isEmpty()&&i.isParentOf(null==s?void 0:s.tempoElement);(null==s?void 0:s.pageBoundingBox)&&(o=s.pageBoundingBox.pageX+s.pageBoundingBox.width/2-e.pageX,n=s.pageBoundingBox.pageY+s.pageBoundingBox.height/2-e.pageY);let u={pageX:e.pageX,pageY:e.pageY,offsetX:o,offsetY:n,parentSelectedElementKey:m?a:null},g=(0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE)||{},T=D(m?g[a]:s);T&&(u.selectedParentDisplay=(0,_.cssEval)(T,"display"),u.selectedParentFlexDirection=(0,_.cssEval)(T,"flex-direction")),(0,r.getMemoryStorageItem)("aiContext")||(0,r.setMemoryStorageItem)("mouseDragContext",u),(0,d.updateOutlines)(t,E)},f=(e,t,E)=>{K(e,t,E);let o=(0,r.getMemoryStorageItem)("mouseDragContext");(0,r.setMemoryStorageItem)("mouseDragContext",null),(null==o?void 0:o.dragging)&&t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.DRAG_END_EVENT,event:{}}),(0,d.updateOutlines)(t,E)},A=(e,t,E)=>{var o,n,a;let i;if((0,r.getSessionStorageItem)("driveModeEnabled",E))return null;let s=(0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE)||{};e.metaKey||e.ctrlKey?(i=s[(0,l.getElementKeyFromNode)(e.target)])||e.target.parentNode!==document.body||(i=m.SELECT_OR_HOVER_STORYBOARD):i=L(e);let _=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY);if(!i)return _&&(t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:null}),(0,r.setMemoryStorageItem)(r.SELECTED_ELEMENT_KEY,null),(0,d.updateOutlines)(t,E)),null;let u=S.TempoElement.fromKey(_),T=(0,r.getMemoryStorageItem)(r.MULTI_SELECTED_ELEMENT_KEYS)||[],M="string"==typeof i?S.TempoElement.forStoryboard(E):i.tempoElement,y=[];if(e.shiftKey&&_){let e=T.map(e=>S.TempoElement.fromKey(e)).find(e=>e.isParentOf(M)||e.isEqual(M));if(e)y=T.filter(t=>t!==e.getKey()),e.isEqual(u)&&y.length>1&&(t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:y[0],outerHTML:null==(o=(0,l.getNodeForElementKey)(y[0]))?void 0:o.outerHTML}),(0,r.setMemoryStorageItem)(r.SELECTED_ELEMENT_KEY,y[0]));else{if(!u.isSiblingOf(M))return null;y=(null==T?void 0:T.length)?T.concat([M.getKey()]):[_,M.getKey()]}}if(y.length>1)return t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,elementKeys:y,outerHTMLs:null==y?void 0:y.map(e=>{var t;return null==(t=(0,l.getNodeForElementKey)(e))?void 0:t.outerHTML})}),(0,r.setMemoryStorageItem)(r.MULTI_SELECTED_ELEMENT_KEYS,y),(0,d.updateOutlines)(t,E),(0,g.teardownEditableText)(t,E),null;1===y.length&&(M=S.TempoElement.fromKey(y[0]));let I=()=>{t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,elementKeys:[],outerHTMLs:[]}),(0,r.setMemoryStorageItem)(r.MULTI_SELECTED_ELEMENT_KEYS,null)};if(M.isStoryboard())return M.getKey()!==_&&(t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:M.getKey(),outerHTML:null==(n=(0,l.getNodeForElementKey)(M.getKey()))?void 0:n.outerHTML}),(0,r.setMemoryStorageItem)(r.SELECTED_ELEMENT_KEY,M.getKey()),(0,d.updateOutlines)(t,E)),(0,g.teardownEditableText)(t,E),I(),null;if((0,g.currentlyEditing)()){let e=(0,g.getEditingInfo)();return(null==e?void 0:e.key)!==_&&(0,g.teardownEditableText)(t,E),I(),null}return e.preventDefault(),e.stopPropagation(),(0,g.canEditText)(M)&&M.getKey()===_&&(0,g.setupEditableText)(M,t,E),M.getKey()===_||(t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:M.getKey(),outerHTML:null==(a=(0,l.getNodeForElementKey)(M.getKey()))?void 0:a.outerHTML}),(0,r.setMemoryStorageItem)(r.SELECTED_ELEMENT_KEY,M.getKey()),(0,d.updateOutlines)(t,E)),I(),i},K=(e,t,E)=>{var o,n;let l=!!(0,r.getSessionStorageItem)("driveModeEnabled",E),a=(0,g.getEditingInfo)();return!!l||!!a||(null==(o=null==e?void 0:e.preventDefault)||o.call(e),null==(n=null==e?void 0:e.stopPropagation)||n.call(e),!1)},R=(e,t,E)=>{var o;let n;if(K(e,t,E))return;e.preventDefault(),e.stopPropagation(),(0,r.setMemoryStorageItem)("mouseDragContext",null);let a=(0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE)||{};e.metaKey||e.ctrlKey?(n=a[(0,l.getElementKeyFromNode)(e.target)])||e.target.parentNode!==document.body||(n=m.SELECT_OR_HOVER_STORYBOARD):n=L(e);let i=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY),s=(0,r.getMemoryStorageItem)(r.MULTI_SELECTED_ELEMENT_KEYS);if(!n||"string"==typeof n){if(n===m.SELECT_OR_HOVER_STORYBOARD&&!(null==s?void 0:s.length)){let e=S.TempoElement.forStoryboard(E).getKey();if(i===e)return;t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:e}),(0,r.setMemoryStorageItem)(r.SELECTED_ELEMENT_KEY,e),(0,d.updateOutlines)(t,E)}return}let _=null,u=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY),g=S.TempoElement.fromKey(u);n.tempoElement.isEqual(g)||g.isParentOf(n.tempoElement)||(null==s?void 0:s.length)||(_=n.tempoElement.getKey(),t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:_,outerHTML:null==(o=(0,l.getNodeForElementKey)(_))?void 0:o.outerHTML}),(0,r.setMemoryStorageItem)(r.SELECTED_ELEMENT_KEY,_),(0,d.updateOutlines)(t,E));let T={clientX:e.clientX,clientY:e.clientY};t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.CONTEXT_REQUESTED,event:T})},h=(e,t,E,n,l)=>o(void 0,void 0,void 0,function*(){let o=E;o||(o=(0,r.getMemoryStorageItem)(r.TREE_ELEMENT_LOOKUP)||{});let s=n;s||(s=(0,r.getMemoryStorageItem)(r.SCOPE_LOOKUP)||{});let d=l;"EXPLICIT_NONE"===l?d=null:d||(d=(0,r.getMemoryStorageItem)(r.STORYBOARD_COMPONENT)||{});let _=new Set,u=new Set;o&&Object.values(o).forEach(e=>{("component"===e.type||"storybook-component"===e.type)&&_.add(e.componentName),"component-instance"===e.type&&u.add(e.componentName)});let S={},g={},T=yield new Promise((e,E)=>{(0,a.buildNavForNodeNonBlocking)({storyboardId:t,parent:void 0,node:(0,i.default)("body").get(0),uniquePathBase:"",uniquePathAddon:"root",scopeLookup:s,treeElements:o,knownComponentNames:_,knownComponentInstanceNames:u,elementKeyToLookupList:S,elementKeyToNavNode:g,domUniquePath:"0"},t=>{e(t)})});(0,r.setMemoryStorageItem)(r.ELEMENT_KEY_TO_LOOKUP_LIST,S),(0,r.setMemoryStorageItem)(r.CURRENT_NAV_TREE,T),(0,r.setMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE,g),e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.NAV_TREE,navTree:T,outerHtml:document.documentElement.outerHTML}),(0,a.runNavTreeBuiltCallbacks)()}),C=()=>{let e=[];(0,i.default)(`*[class*=${l.TEMPO_INSTANT_UPDATE_STYLING_PREFIX}]`).each((t,E)=>{(E.getAttribute("class")||"").split(" ").forEach(t=>{t.startsWith(l.TEMPO_INSTANT_UPDATE_STYLING_PREFIX)&&e.push(t)})}),(0,i.default)(`*[${l.TEMPO_DELETE_AFTER_REFRESH}=true]`).attr(l.TEMPO_QUEUE_DELETE_AFTER_HOT_RELOAD,"true"),(0,r.setMemoryStorageItem)(u.ADD_CLASS_INSTANT_UPDATE_QUEUE,[]),(0,r.setMemoryStorageItem)("POST_HOT_RELOAD_CLEAR",{classesToDelete:e})},w=(e,E)=>o(void 0,void 0,void 0,function*(){t(()=>{(0,r.setMemoryStorageItem)(I,new Date);let{classesToDelete:e}=(0,r.getMemoryStorageItem)("POST_HOT_RELOAD_CLEAR")||{};(0,i.default)(`*[${l.TEMPO_QUEUE_DELETE_AFTER_HOT_RELOAD}=true]`).remove(),(0,i.default)(`.${l.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS}`).removeClass(l.TEMPO_DISPLAY_NONE_UNTIL_REFRESH_CLASS),(0,i.default)(`*[${l.TEMPO_INSTANT_UPDATE}=true]`).removeAttr(l.TEMPO_INSTANT_UPDATE),(0,i.default)(`*[${l.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH}=true]`).removeAttr(l.TEMPO_DO_NOT_SHOW_IN_NAV_UNTIL_REFRESH),(0,i.default)(`.${u.TEMPORARY_STYLING_CLASS_NAME}`).removeClass(u.TEMPORARY_STYLING_CLASS_NAME),null==e||e.forEach(e=>{(0,i.default)(`.${e}`).removeClass(e)}),((0,r.getMemoryStorageItem)(u.ADD_CLASS_INSTANT_UPDATE_QUEUE)||[]).forEach(e=>{if(!e)return;let{codebaseId:t,className:E}=e;t&&E&&((0,i.default)(`.${t}`).attr(l.TEMPO_INSTANT_UPDATE,"true"),(0,i.default)(`.${t}`).addClass(E))})});try{yield(0,M.sleep)(300),t(()=>o(void 0,void 0,void 0,function*(){yield h(e,E),(0,d.updateOutlines)(e,E)}))}catch(e){console.error("ERROR: Could not re-create nav tree on DOM change, "+e)}}),Y=({mutations:e,parentPort:t,storyboardId:E,fromNextJsLoader:o})=>{var n;(0,r.getMemoryStorageItem)("href")!==window.location.href&&(t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.LATEST_HREF,href:window.location.href}),(0,r.setMemoryStorageItem)("href",window.location.href));let a=!1;if(o){let t=null==(n=null==e?void 0:e[0])?void 0:n.target;t&&"container"===t.id&&((0,r.getMemoryStorageItem)(r.HOT_RELOADING),t.classList.contains("visible")?(0,r.setMemoryStorageItem)(r.HOT_RELOADING,!0):((0,r.setMemoryStorageItem)(r.HOT_RELOADING,!1),a=!0))}else e.forEach(e=>{if(!a){if("attributes"===e.type&&"class"===e.attributeName&&e.target&&!(0,d.isNodeOutline)(e.target)&&!(0,l.isMovingElement)(e.target)&&!e.target.tagName.toLowerCase().includes("script")){(0,l.isElementInSvg)(e.target)||(a=!0);return}[e.addedNodes,e.removedNodes].forEach(e=>{!a&&e&&e.forEach(e=>{if(!(0,d.isNodeOutline)(e)&&!(0,l.isMovingElement)(e)){a=!0;return}})})}});if(a){if(o){let e=new Date;setTimeout(()=>{let o=(0,r.getMemoryStorageItem)(I);(!o||o<e)&&w(t,E)},1e3);return}w(t,E)}},F=(e,t,E)=>{let o=K(e,t,E),n=e.altKey;if(!(e.ctrlKey||e.metaKey)&&(o||n))return;e.preventDefault(),e.stopPropagation();let l={deltaX:e.deltaX,deltaY:e.deltaY,wheelDelta:e.wheelDelta,x:e.x,y:e.y,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey};t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.WHEEL_EVENT,event:l})},P=()=>{let e,t,E,o=document.activeElement;return o&&(e=o.tagName,o instanceof HTMLElement&&(t=o.isContentEditable),o instanceof HTMLInputElement&&(E=o.type)),{tagName:e,isContentEditable:t,elementType:E}},b=(e,t)=>{t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.KEY_DOWN_EVENT,event:{key:e.key,metaKey:e.metaKey,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,activeElement:Object.assign({},P())}})},H=(e,t)=>{t.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.KEY_UP_EVENT,event:{key:e.key,metaKey:e.metaKey,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,activeElement:Object.assign({},P())}})},U=s.default.throttle((e,t)=>(0,d.updateOutlines)(e,t),15),V=(e,t,E)=>{U(t,E)};window.initProject=(e,E,o,l,a,s={},_,m,u)=>{let S=n();S.capture=!0;let g=(0,i.default)("body");(0,r.setMemoryStorageItem)(r.TREE_ELEMENT_LOOKUP,o),(0,r.setMemoryStorageItem)(r.SCOPE_LOOKUP,l),a&&(0,r.setMemoryStorageItem)(r.STORYBOARD_COMPONENT,a),(0,r.setMemoryStorageItem)(r.STORYBOARD_TYPE,_),(0,r.setMemoryStorageItem)(r.SAVED_STORYBOARD_COMPONENT_FILENAME,m),u&&(0,r.setMemoryStorageItem)(r.ORIGINAL_STORYBOARD_URL,u),(0,r.removeMemoryStorageItem)(r.SELECTED_ELEMENT_KEY),(0,r.removeMemoryStorageItem)(r.HOVERED_ELEMENT_KEY),(0,d.updateOutlines)(e,E);let M=g.get(0);null==M||M.addEventListener("click",t=>{K(t,e,E)},S),null==M||M.addEventListener("pointerover",t=>{O(t,e,E)},S),null==M||M.addEventListener("pointerdown",t=>{v(t,e,E)},S),null==M||M.addEventListener("pointerup",t=>{f(t,e,E)},S),null==M||M.addEventListener("pointermove",t=>{N(t,e,E)},S),null==M||M.addEventListener("pointerleave",t=>{K(t,e,E)},S),null==M||M.addEventListener("contextmenu",t=>{R(t,e,E)},S),null==M||M.addEventListener("dblclick",t=>{K(t,e,E)},S),null==M||M.addEventListener("mouseover",t=>{K(t,e,E)},S),null==M||M.addEventListener("mouseout",t=>{K(t,e,E)},S),null==M||M.addEventListener("mousemove",t=>{K(t,e,E)},S),null==M||M.addEventListener("mousedown",t=>{K(t,e,E)},S),null==M||M.addEventListener("mouseup",t=>{K(t,e,E)},S),null==M||M.addEventListener("wheel",t=>{F(t,e,E)},S),null==M||M.addEventListener("keydown",t=>{b(t,e)},S),null==M||M.addEventListener("keyup",t=>{H(t,e)},S),window.addEventListener("scroll",t=>{V(t,e,E)},S),document.addEventListener("pointerlockchange",()=>{document.pointerLockElement&&(0,r.getMemoryStorageItem)(y)&&(document.exitPointerLock(),(0,r.setMemoryStorageItem)(y,!1))},!1);let I=new T.DebounceExecutor,L=[M],p=document.getElementById("__next-build-watcher");p&&p.shadowRoot&&L.push(...Array.from(p.shadowRoot.children)),t=c(L,t=>{I.schedule(()=>{Y({mutations:t,parentPort:e,storyboardId:E})})}),s.driveModeEnabled?X(e,E):x(e,E),s.aiContextSelection?(0,r.setMemoryStorageItem)("aiContext",!0):(0,r.setMemoryStorageItem)("aiContext",!1),(0,d.updateOutlines)(e,E);try{t(()=>{h(e,E,o,l,a||"EXPLICIT_NONE")})}catch(e){console.log(e),console.error("Error building nav tree: "+e)}};let X=(e,t)=>{(0,r.getSessionStorageItem)("driveModeEnabled",t)||((0,r.setSessionStorageItem)("driveModeEnabled","enabled",t),p(e,t),(0,d.clearAllOutlines)()),(0,i.default)("body").css("cursor","")},x=(e,t)=>{(0,r.getSessionStorageItem)("driveModeEnabled",t)&&((0,r.removeSessionStorageItem)("driveModeEnabled",t),(0,d.updateOutlines)(e,t),p(e,t)),(0,i.default)("body").attr("style",function(e,t){return(t||"")+"cursor: default !important;"})};window.enableDriveMode=(e,t)=>{X(e,t)},window.disableDriveMode=(e,t)=>{x(e,t)},window.setNewLookups=(e,t,E,o)=>{let n=(0,r.getMemoryStorageItem)(r.TREE_ELEMENT_LOOKUP)||{},l=(0,r.getMemoryStorageItem)(r.SCOPE_LOOKUP)||{},a=Object.assign({},n);Object.keys(E).forEach(e=>{E[e]?a[e]=E[e]:a[e]&&delete a[e]});let i=Object.assign({},l);Object.keys(o).forEach(e=>{o[e]?i[e]=o[e]:i[e]&&delete i[e]}),(0,r.setMemoryStorageItem)(r.TREE_ELEMENT_LOOKUP,a),(0,r.setMemoryStorageItem)(r.SCOPE_LOOKUP,i)},window.setHoveredElement=(e,t,E)=>{(0,r.getSessionStorageItem)("driveModeEnabled",t)||(0,r.getMemoryStorageItem)(r.HOVERED_ELEMENT_KEY)!==E&&(E?(0,r.setMemoryStorageItem)(r.HOVERED_ELEMENT_KEY,E):(0,r.removeMemoryStorageItem)(r.HOVERED_ELEMENT_KEY),(0,d.updateOutlines)(e,t))},window.setSelectedElement=(e,t,E)=>{var o,n;if((0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY)!==E){if(E){let a=S.TempoElement.fromKey(E),i=E;if(a.isStoryboard(t)){let e=(0,r.getMemoryStorageItem)(r.CURRENT_NAV_TREE),t=null==(o=null==e?void 0:e.tempoElement)?void 0:o.getKey();t&&(i=t)}e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,doNotSetElementKey:!0,outerHTML:null==(n=(0,l.getNodeForElementKey)(i))?void 0:n.outerHTML}),(0,r.setMemoryStorageItem)(r.SELECTED_ELEMENT_KEY,E)}else e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,doNotSetElementKey:!0,outerHTML:null}),(0,r.removeMemoryStorageItem)(r.SELECTED_ELEMENT_KEY);(0,d.updateOutlines)(e,t)}},window.setMultiselectedElementKeys=(e,t,E)=>{let o=new Set((0,r.getMemoryStorageItem)(r.MULTI_SELECTED_ELEMENT_KEYS)||[]),n=new Set(E||[]);o.size===n.size&&[...o].every(e=>n.has(e))||(E?((0,r.setMemoryStorageItem)(r.MULTI_SELECTED_ELEMENT_KEYS,E),e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,doNotSetElementKeys:!0,outerHTMLs:null==E?void 0:E.map(e=>{var t;return null==(t=(0,l.getNodeForElementKey)(e))?void 0:t.outerHTML})})):((0,r.removeMemoryStorageItem)(r.MULTI_SELECTED_ELEMENT_KEYS),e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.MULTI_SELECTED_ELEMENT_KEYS,doNotSetElementKeys:!0,outerHTMLs:[]})),(0,d.updateOutlines)(e,t))},window.processRulesForSelectedElement=(e,t,E,o)=>{(0,_.processRulesForSelectedElement)(e,E,o)},window.setModifiersForSelectedElement=(e,t,E,o)=>{(0,_.setModifiersForSelectedElement)(e,E,o)},window.getCssEvals=(e,t,E)=>{(0,_.getCssEvals)(e,E)},window.ruleMatchesElement=(e,t,E,o,n)=>{(0,_.ruleMatchesElement)(e,E,o,n)},window.getElementClassList=(e,t,E)=>{(0,_.getElementClassList)(e,E)},window.applyChangeItemToDocument=(e,t,E)=>o(void 0,void 0,void 0,function*(){let{sendNewNavTree:o}=(0,u.applyChangeItemToDocument)(e,t,E);o&&(yield h(e,t)),(0,d.updateOutlines)(e,t)}),window.updateCodebaseIds=(e,t,E,n,l)=>o(void 0,void 0,void 0,function*(){(0,u.updateCodebaseIds)(e,E,!0)&&(yield h(e,t,n,l)),(0,d.updateOutlines)(e,t)}),window.dispatchEvent=(e,t,E,o)=>{let n=new CustomEvent(E,Object.assign({},o));document.dispatchEvent(n)},window.updateOutlines=(e,t)=>{(0,d.updateOutlines)(e,t)},window.goBack=(e,t)=>{""!==document.referrer&&window.history.back()},window.goForward=(e,t)=>{window.history.forward()},window.refresh=(e,t)=>{window.location.reload()},window.syntheticMouseOver=(e,t,E,o,n)=>{let a=document.elementFromPoint(E.x,E.y);if(o){let E=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY);if(!S.TempoElement.fromKey(E).isEmpty()){let o=(0,l.getNodeForElementKey)(E);if(null==o?void 0:o.contains(a))return void O({target:o},e,t)}}O({target:a},e,t,n)},window.syntheticMouseMove=(e,t,E)=>{N(Object.assign(Object.assign({},E),{pageX:E.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),pageY:E.clientY+(document.documentElement.scrollTop||document.body.scrollTop)}),e,t)},window.syntheticMouseUp=(e,t,E)=>{f(E,e,t)},window.clearHoveredOutlines=(e,t)=>{(0,r.getMemoryStorageItem)(r.HOVERED_ELEMENT_KEY)&&p(e,t)},window.setZoomPerc=(e,t,E)=>{(0,r.setMemoryStorageItem)("zoomPerc",E.toString()),(0,d.updateOutlines)(e,t)},window.setAiContext=(e,t,E)=>{(0,r.setMemoryStorageItem)("aiContext",!!E),(0,d.updateOutlines)(e,t)},window.tempMoveElement=(e,t,E,n)=>o(void 0,void 0,void 0,function*(){var o,a,s,_,u;let g=((0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE)||{})[E];if(!g)return;let T=S.TempoElement.fromKey(E),M=[],y=(0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_LOOKUP_LIST)||{};(y[g.tempoElement.getKey()]||[]).forEach(e=>{M.push((0,l.getNodeForElementKey)(e))});let I=null==(o=M[0])?void 0:o.parentElement,c=g.parent;if(I&&c){let E=null==(a=null==c?void 0:c.children)?void 0:a.indexOf(g),o=null==(s=null==c?void 0:c.children)?void 0:s.length;if(E!==n){if(Array.from(I.children).forEach(e=>{(0,i.default)(e).attr(l.TEMPO_INSTANT_UPDATE,"true")}),(0,i.default)(I).attr(l.TEMPO_INSTANT_UPDATE,"true"),n===o-1)M.forEach(e=>{e.parentElement.appendChild(e)});else{let e=E>n?null==c?void 0:c.children[n]:null==c?void 0:c.children[n+1],t=y[null==(_=null==e?void 0:e.tempoElement)?void 0:_.getKey()]||[];if(!t.length)return void console.log("Cannot find element to insert before in lookup list");let o=(0,l.getNodeForElementKey)(t[0]);if(!o)return void console.log("Cannot find element to insert before");M.forEach(e=>{e.parentElement.insertBefore(e,o)})}let a=T.uniquePath.split("-"),s=a.slice(0,a.length-1).join("-")+`-${n}`,g=new S.TempoElement(T.codebaseId,T.storyboardId,s).getKey();yield h(e,t),e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.SELECTED_ELEMENT_KEY,elementKey:g,outerHTML:null==(u=(0,l.getNodeForElementKey)(g))?void 0:u.outerHTML}),(0,r.setMemoryStorageItem)(r.SELECTED_ELEMENT_KEY,g),(0,d.updateOutlines)(e,t)}}}),window.tempAddDiv=(e,t,E,n,r,a)=>o(void 0,void 0,void 0,function*(){let o=(0,i.default)(`.${l.TEMPO_INSTANT_DIV_DRAW_CLASS}`);if(o.length)o.css("width",r),o.css("height",a);else{let o=(0,i.default)(`.${E}`);o.length||(o=(0,i.default)("body")),o.each((e,t)=>{let E=(0,i.default)(`<div class="${l.TEMPO_INSTANT_DIV_DRAW_CLASS}" ${l.TEMPO_DELETE_AFTER_INSTANT_UPDATE}="true" ${l.TEMPO_DELETE_AFTER_REFRESH}="true" ${l.TEMPO_INSTANT_UPDATE}="true"></div>`),o=(0,i.default)(t).children().eq(n);(null==o?void 0:o.length)?o.before(E):(0,i.default)(t).append(E)}),yield h(e,t)}(0,d.updateOutlines)(e,t)}),window.tempMoveToNewParent=(e,t,E,o,n,r,a,s)=>{if((0,i.default)(`.${l.TEMPO_MOVE_BETWEEN_PARENTS_OUTLINE}`).remove(),s)return;let _=document.createElement("div");_.classList.add(l.TEMPO_MOVE_BETWEEN_PARENTS_OUTLINE),_.setAttribute(l.TEMPO_INSTANT_UPDATE,"true"),_.style.width=E+"px",_.style.height=o+"px",_.style.left=n+"px",_.style.top=r+"px",_.style.position="fixed",_.style.pointerEvents="none",_.style.zIndex="2000000004",_.style.boxSizing="border-box",_.style.cursor="default !important",_.style.backgroundColor=d.PRIMARY_OUTLINE_COLOUR;let m=document.getElementsByTagName("body")[0];m.appendChild(_);let u=(0,l.getNodeForElementKey)(a);if(u){let t=u.getBoundingClientRect(),E=(0,d.getOutlineElement)(e,d.OutlineType.PRIMARY,t.left,t.top,t.width,t.height);E.classList.remove(l.OUTLINE_CLASS),E.classList.add(l.TEMPO_MOVE_BETWEEN_PARENTS_OUTLINE),E.setAttribute(l.TEMPO_INSTANT_UPDATE,"true"),m.appendChild(E)}},window.checkIfHydrationError=(e,t)=>{var E,o,n,l,r,a,i,s,d,_,u,S,g,T,M;let y,I,c,L;if(window.location.href.includes("framework=VITE")){let e=null==(E=document.getElementsByTagName("vite-error-overlay")[0])?void 0:E.shadowRoot;y="A Vite Error Occurred",I=null==(l=null==(n=null==(o=null==e?void 0:e.querySelectorAll)?void 0:o.call(e,".file-link"))?void 0:n[0])?void 0:l.innerHTML,c=null==(i=null==(a=null==(r=null==e?void 0:e.querySelectorAll)?void 0:r.call(e,".message"))?void 0:a[0])?void 0:i.innerHTML,L=!!(I||c)}else{let e=null==(s=document.getElementsByTagName("nextjs-portal")[0])?void 0:s.shadowRoot;y=null==(_=null==(d=null==e?void 0:e.getElementById)?void 0:d.call(e,"nextjs__container_errors_desc"))?void 0:_.innerHTML,I=null==(S=null==(u=null==e?void 0:e.getElementById)?void 0:u.call(e,"nextjs__container_errors_label"))?void 0:S.innerHTML,c=null==(M=null==(T=null==(g=null==e?void 0:e.querySelectorAll)?void 0:g.call(e,".nextjs-container-errors-body"))?void 0:T[0])?void 0:M.innerHTML,L=!!y}L?(null==y?void 0:y.includes("Hydration failed"))?e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.LATEST_HYDRATION_ERROR_STATUS,status:m.STORYBOARD_HYDRATION_STATUS.ERROR,errorDescr:y,errorLabel:I,errorBody:c}):e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.LATEST_HYDRATION_ERROR_STATUS,status:m.STORYBOARD_HYDRATION_STATUS.OTHER_ERROR,errorDescr:y,errorLabel:I,errorBody:c}):e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.LATEST_HYDRATION_ERROR_STATUS,status:m.STORYBOARD_HYDRATION_STATUS.NO_ERROR})},window.triggerDragStart=(e,t)=>{let E=(0,r.getMemoryStorageItem)(r.SELECTED_ELEMENT_KEY),o=(0,r.getMemoryStorageItem)(r.ELEMENT_KEY_TO_NAV_NODE)||{};if(!E)return;let n=D(o[E]),a=(0,l.getNodeForElementKey)(E),i={pageX:-1e4,pageY:-1e4,offsetX:0,offsetY:0,dragging:!0,selectedParentDisplay:(0,_.cssEval)(n,"display"),selectedParentFlexDirection:(0,_.cssEval)(n,"flex-direction")};(0,r.setMemoryStorageItem)("mouseDragContext",i),e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.DRAG_START_EVENT,event:i,outerHTML:null==a?void 0:a.outerHTML}),(0,d.updateOutlines)(e,t)},window.triggerDragCancel=(e,t)=>{(0,r.setMemoryStorageItem)("mouseDragContext",null),e.postMessage({id:m.FIXED_IFRAME_MESSAGE_IDS.DRAG_CANCEL_EVENT,event:{}}),(0,d.updateOutlines)(e,t)},window.setIsFlushing=(e,t,E)=>{let o=(0,r.getMemoryStorageItem)(r.IS_FLUSHING);(0,r.setMemoryStorageItem)(r.IS_FLUSHING,E),E&&!o&&C()}}}}]);